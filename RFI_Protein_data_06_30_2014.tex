\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}
\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{2}
\usepackage{url}
\usepackage[unicode=true,pdfusetitle,
            bookmarks=true,bookmarksnumbered=true,bookmarksopen=true,bookmarksopenlevel=2,
            breaklinks=false,pdfborder={0 0 1},backref=false,colorlinks=false]
{hyperref}
\hypersetup{
  pdfstartview={XYZ null null 1}}
\usepackage{breakurl}
\usepackage{amsmath,amsthm,amssymb, graphicx}
 \usepackage{latexsym}
\usepackage{amssymb}
\usepackage{graphicx}
%\usepackage{undertilde}
\usepackage{accents}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{bmpsize}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}







\title{Analyze Protein Data}%replace X with the appropriate number
\author{} 
\maketitle




\section{Cleaning the data}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{## Protein of interest for tech paper 01/27/2014}
\hlkwd{library}\hlstd{(}\hlstr{"lme4"}\hlstd{)}
\hlkwd{library}\hlstd{(}\hlstr{"plyr"}\hlstd{)}
\hlkwd{library}\hlstd{(}\hlstr{"ggplot2"}\hlstd{)}
\hlkwd{library}\hlstd{(}\hlstr{"MASS"}\hlstd{)}
\hlcom{# read data}
\hlstd{dat} \hlkwb{<-} \hlkwd{read.csv}\hlstd{(}\hlstr{"Proteins of Interst for Tech Paper.csv"}\hlstd{)}

\hlkwd{dim}\hlstd{(dat)}
\end{alltt}
\begin{verbatim}
## [1] 238  66
\end{verbatim}
\begin{alltt}
\hlstd{x} \hlkwb{<-} \hlkwd{colnames}\hlstd{(dat)}  \hlcom{# column name of data}
\hlstd{x}
\end{alltt}
\begin{verbatim}
##  [1] "BVAExport"                            "Image"                               
##  [3] "Gel_1_Run_1_Pig_1807_45034.CY3.gel"   "X"                                   
##  [5] "Gel_1_Run_1_Pig_1807_45034.CY5.gel"   "X.1"                                 
##  [7] "Gel_1_Run_2_Pig_1807_45046.CY3.gel"   "X.2"                                 
##  [9] "Gel_1_Run_2_Pig_1807_45046.CY5.gel"   "X.3"                                 
## [11] "Gel_2_Run_2_Pig_4810_45047.CY3.gel"   "X.4"                                 
## [13] "Gel_2_Run_2_Pig_4810_45047.CY5.gel"   "X.5"                                 
## [15] "Gel_2_Run_2_Pig_4810_45047.CY3.gel.1" "X.6"                                 
## [17] "Gel_2_Run_2_Pig_4810_45047.CY5.gel.1" "X.7"                                 
## [19] "Gel_3_Run_1_Pig_1209_45036.CY3.gel"   "X.8"                                 
## [21] "Gel_3_Run_1_Pig_1209_45036.CY5.gel"   "X.9"                                 
## [23] "Gel_3_Run_2_Pig_1209_45048.CY3.gel"   "X.10"                                
## [25] "Gel_3_Run_2_Pig_1209_45048.CY5.gel"   "X.11"                                
## [27] "Gel_4_Run_1_Pig_1906_45037.CY3.gel"   "X.12"                                
## [29] "Gel_4_Run_1_Pig_1906_45037.CY5.gel"   "X.13"                                
## [31] "Gel_4_Run_2_Pig_1906_45049.CY3.gel"   "X.14"                                
## [33] "Gel_4_Run_2_Pig_1906_45049.CY5.gel"   "X.15"                                
## [35] "Gel_5_Run_1_Pig_3908_45038.CY3.gel"   "X.16"                                
## [37] "Gel_5_Run_1_Pig_3908_45038.CY5.gel"   "X.17"                                
## [39] "Gel_5_Run_2_Pig_3908_45050.CY3.gel"   "X.18"                                
## [41] "Gel_5_Run_2_Pig_3908_45050.CY5.gel"   "X.19"                                
## [43] "Gel_6_Run_1_Pig_3106_45039.CY3.gel"   "X.20"                                
## [45] "Gel_6_Run_1_Pig_3106_45039.CY5.gel"   "X.21"                                
## [47] "Gel_6_Run_2_Pig_3106_45051.CY3.gel"   "X.22"                                
## [49] "Gel_6_Run_2_Pig_3106_45051.CY5.gel"   "X.23"                                
## [51] "Gel_7_Run_1_Pig_2107_45040.CY3.gel"   "X.24"                                
## [53] "Gel_7_Run_1_Pig_2107_45040.CY5.gel"   "X.25"                                
## [55] "Gel_7_Run_2_Pig_2107_45052.CY3.gel"   "X.26"                                
## [57] "Gel_7_Run_2_Pig_2107_45052.CY5.gel"   "X.27"                                
## [59] "Gel_8_Run_1_Pig_2712_45041.CY3.gel"   "X.28"                                
## [61] "Gel_8_Run_1_Pig_2712_45041.CY5.gel"   "X.29"                                
## [63] "Gel_8_Run_2_Pig_2712_44495.CY3.gel"   "X.30"                                
## [65] "Gel_8_Run_2_Pig_2712_44495.CY5.gel"   "X.31"
\end{verbatim}
\end{kframe}
\end{knitrout}



\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{y} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"Image"}\hlstd{,} \hlstr{"X"}\hlstd{,} \hlkwd{paste}\hlstd{(}\hlstr{"X."}\hlstd{,} \hlnum{1}\hlopt{:}\hlnum{31}\hlstd{,} \hlkwc{sep} \hlstd{=} \hlstr{""}\hlstd{))}  \hlcom{# Column name unsued}

\hlcom{# Column name used in analysis including the id of protein and 16 gels of 8 animals, each gel runs}
\hlcom{# twice}

\hlstd{use_col} \hlkwb{<-} \hlkwd{setdiff}\hlstd{(x, y)}
\hlstd{use_col}
\end{alltt}
\begin{verbatim}
##  [1] "BVAExport"                            "Gel_1_Run_1_Pig_1807_45034.CY3.gel"  
##  [3] "Gel_1_Run_1_Pig_1807_45034.CY5.gel"   "Gel_1_Run_2_Pig_1807_45046.CY3.gel"  
##  [5] "Gel_1_Run_2_Pig_1807_45046.CY5.gel"   "Gel_2_Run_2_Pig_4810_45047.CY3.gel"  
##  [7] "Gel_2_Run_2_Pig_4810_45047.CY5.gel"   "Gel_2_Run_2_Pig_4810_45047.CY3.gel.1"
##  [9] "Gel_2_Run_2_Pig_4810_45047.CY5.gel.1" "Gel_3_Run_1_Pig_1209_45036.CY3.gel"  
## [11] "Gel_3_Run_1_Pig_1209_45036.CY5.gel"   "Gel_3_Run_2_Pig_1209_45048.CY3.gel"  
## [13] "Gel_3_Run_2_Pig_1209_45048.CY5.gel"   "Gel_4_Run_1_Pig_1906_45037.CY3.gel"  
## [15] "Gel_4_Run_1_Pig_1906_45037.CY5.gel"   "Gel_4_Run_2_Pig_1906_45049.CY3.gel"  
## [17] "Gel_4_Run_2_Pig_1906_45049.CY5.gel"   "Gel_5_Run_1_Pig_3908_45038.CY3.gel"  
## [19] "Gel_5_Run_1_Pig_3908_45038.CY5.gel"   "Gel_5_Run_2_Pig_3908_45050.CY3.gel"  
## [21] "Gel_5_Run_2_Pig_3908_45050.CY5.gel"   "Gel_6_Run_1_Pig_3106_45039.CY3.gel"  
## [23] "Gel_6_Run_1_Pig_3106_45039.CY5.gel"   "Gel_6_Run_2_Pig_3106_45051.CY3.gel"  
## [25] "Gel_6_Run_2_Pig_3106_45051.CY5.gel"   "Gel_7_Run_1_Pig_2107_45040.CY3.gel"  
## [27] "Gel_7_Run_1_Pig_2107_45040.CY5.gel"   "Gel_7_Run_2_Pig_2107_45052.CY3.gel"  
## [29] "Gel_7_Run_2_Pig_2107_45052.CY5.gel"   "Gel_8_Run_1_Pig_2712_45041.CY3.gel"  
## [31] "Gel_8_Run_1_Pig_2712_45041.CY5.gel"   "Gel_8_Run_2_Pig_2712_44495.CY3.gel"  
## [33] "Gel_8_Run_2_Pig_2712_44495.CY5.gel"
\end{verbatim}
\begin{alltt}
\hlstd{dat_used} \hlkwb{<-} \hlkwd{as.matrix}\hlstd{(dat[, use_col])}
\hlkwd{dim}\hlstd{(dat_used)}
\end{alltt}
\begin{verbatim}
## [1] 238  33
\end{verbatim}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# The first row is group classification, the second row is the name of Std. Abund, therefore the data}
\hlcom{# actually in use is the dat_used except the first 2 rows}
\hlstd{dat_final} \hlkwb{<-} \hlkwd{matrix}\hlstd{(}\hlkwd{as.numeric}\hlstd{(dat_used[}\hlopt{-}\hlkwd{c}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{2}\hlstd{), ]),} \hlkwc{nrow} \hlstd{=} \hlkwd{nrow}\hlstd{(dat_used)} \hlopt{-} \hlnum{2}\hlstd{,} \hlkwc{ncol} \hlstd{=} \hlkwd{ncol}\hlstd{(dat_used),}
    \hlkwc{byrow} \hlstd{= F)}
\hlkwd{dim}\hlstd{(dat_final)}
\end{alltt}
\begin{verbatim}
## [1] 236  33
\end{verbatim}
\begin{alltt}


\end{alltt}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Group of each sample}

\hlstd{group} \hlkwb{<-} \hlstd{dat_used[}\hlnum{1}\hlstd{,} \hlopt{-}\hlnum{1}\hlstd{]}
\hlstd{group}
\end{alltt}
\begin{verbatim}
##   Gel_1_Run_1_Pig_1807_45034.CY3.gel   Gel_1_Run_1_Pig_1807_45034.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_1_Run_2_Pig_1807_45046.CY3.gel   Gel_1_Run_2_Pig_1807_45046.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_2_Run_2_Pig_4810_45047.CY3.gel   Gel_2_Run_2_Pig_4810_45047.CY5.gel 
##                           "Depleted"                              "Whole" 
## Gel_2_Run_2_Pig_4810_45047.CY3.gel.1 Gel_2_Run_2_Pig_4810_45047.CY5.gel.1 
##                           "Depleted"                              "Whole" 
##   Gel_3_Run_1_Pig_1209_45036.CY3.gel   Gel_3_Run_1_Pig_1209_45036.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_3_Run_2_Pig_1209_45048.CY3.gel   Gel_3_Run_2_Pig_1209_45048.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_4_Run_1_Pig_1906_45037.CY3.gel   Gel_4_Run_1_Pig_1906_45037.CY5.gel 
##                           "Depleted"                              "Whole" 
##   Gel_4_Run_2_Pig_1906_45049.CY3.gel   Gel_4_Run_2_Pig_1906_45049.CY5.gel 
##                           "Depleted"                              "Whole" 
##   Gel_5_Run_1_Pig_3908_45038.CY3.gel   Gel_5_Run_1_Pig_3908_45038.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_5_Run_2_Pig_3908_45050.CY3.gel   Gel_5_Run_2_Pig_3908_45050.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_6_Run_1_Pig_3106_45039.CY3.gel   Gel_6_Run_1_Pig_3106_45039.CY5.gel 
##                           "Depleted"                              "Whole" 
##   Gel_6_Run_2_Pig_3106_45051.CY3.gel   Gel_6_Run_2_Pig_3106_45051.CY5.gel 
##                           "Depleted"                              "Whole" 
##   Gel_7_Run_1_Pig_2107_45040.CY3.gel   Gel_7_Run_1_Pig_2107_45040.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_7_Run_2_Pig_2107_45052.CY3.gel   Gel_7_Run_2_Pig_2107_45052.CY5.gel 
##                              "Whole"                           "Depleted" 
##   Gel_8_Run_1_Pig_2712_45041.CY3.gel   Gel_8_Run_1_Pig_2712_45041.CY5.gel 
##                           "Depleted"                              "Whole" 
##   Gel_8_Run_2_Pig_2712_44495.CY3.gel   Gel_8_Run_2_Pig_2712_44495.CY5.gel 
##                           "Depleted"                              "Whole"
\end{verbatim}
\begin{alltt}
\hlcom{# Obtain data for each group: depleted and whole, the first column of dat_final contains name of}
\hlcom{# protein}
\hlstd{deplete} \hlkwb{<-} \hlstd{dat_final[,} \hlopt{-}\hlnum{1}\hlstd{][, group} \hlopt{==} \hlstr{"Depleted"}\hlstd{]}
\hlkwd{dim}\hlstd{(deplete)}
\end{alltt}
\begin{verbatim}
## [1] 236  16
\end{verbatim}
\begin{alltt}
\hlstd{whole} \hlkwb{<-} \hlstd{dat_final[,} \hlopt{-}\hlnum{1}\hlstd{][, group} \hlopt{==} \hlstr{"Whole"}\hlstd{]}
\hlkwd{dim}\hlstd{(whole)}
\end{alltt}
\begin{verbatim}
## [1] 236  16
\end{verbatim}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# Find out which Cy is used for each run}

\hlstd{group[group} \hlopt{==} \hlstr{"depleted"}\hlstd{]}  \hlcom{# Cy for depleted group: rep(c(5,5,3,3),4)}
\end{alltt}
\begin{verbatim}
## named character(0)
\end{verbatim}
\begin{alltt}
\hlstd{group[group} \hlopt{==} \hlstr{"whole"}\hlstd{]}  \hlcom{# Cy for whole group: rep(c(3,3,5,5),4)}
\end{alltt}
\begin{verbatim}
## named character(0)
\end{verbatim}
\end{kframe}
\end{knitrout}

\section{Function to fit a Linear Mixed Effect Model for each spot in each group}
Function to fit a linear mixed model for each spot, with fixed effect is Cy, and random effect is animal.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{out_model} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{,} \hlkwc{depleted}\hlstd{)\{} \hlcom{# x is the row of data (i.e., data of each protein spot)}
  \hlkwa{if} \hlstd{(depleted} \hlopt{==} \hlstr{"TRUE"}\hlstd{)\{}
    \hlstd{cy} \hlkwb{<-} \hlkwd{as.factor}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{5}\hlstd{,}\hlnum{5}\hlstd{,}\hlnum{3}\hlstd{,}\hlnum{3}\hlstd{),}\hlnum{4}\hlstd{))}
  \hlstd{\}} \hlkwa{else} \hlstd{\{}
    \hlstd{cy} \hlkwb{<-} \hlkwd{as.factor}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{3}\hlstd{,}\hlnum{3}\hlstd{,}\hlnum{5}\hlstd{,}\hlnum{5}\hlstd{),}\hlnum{4}\hlstd{))}
  \hlstd{\}}
  \hlstd{animal} \hlkwb{<-} \hlkwd{as.factor}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{8}\hlstd{,} \hlkwc{each} \hlstd{=} \hlnum{2}\hlstd{))}
  \hlstd{line} \hlkwb{<-} \hlkwd{as.factor}\hlstd{(}\hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{2}\hlstd{),} \hlkwc{each} \hlstd{=} \hlnum{8}\hlstd{))}
  \hlcom{# check if all obsetvations for one Cy are missing or not}

  \hlkwa{if} \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{3}\hlstd{]))}\hlopt{==}\hlnum{8}\hlopt{|}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{5}\hlstd{]))}\hlopt{==}\hlnum{8}\hlstd{)} \hlopt{&}
        \hlstd{(}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{1}\hlstd{]))}\hlopt{==}\hlnum{8}\hlopt{|}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{2}\hlstd{]))}\hlopt{==}\hlnum{8}\hlstd{))\{}
    \hlstd{model} \hlkwb{<-} \hlkwd{lmer}\hlstd{(x}\hlopt{~} \hlstd{(}\hlnum{1}\hlopt{|}\hlstd{animal),} \hlkwc{na.action}\hlstd{=}\hlstr{"na.omit"}\hlstd{)}
    \hlstd{mean_est} \hlkwb{<-} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[,}\hlnum{1}\hlstd{]}
    \hlstd{sd_est} \hlkwb{<-} \hlkwd{as.vector}\hlstd{(}\hlkwd{sqrt}\hlstd{(}\hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{vcov))}
    \hlcom{#str(summary(model))}
  \hlstd{\}}
  \hlkwa{if} \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{3}\hlstd{]))}\hlopt{==}\hlnum{8}\hlopt{|}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{5}\hlstd{]))}\hlopt{==}\hlnum{8}\hlstd{)} \hlopt{&}
        \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{1}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)}\hlopt{&}\hlstd{(}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{2}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)))\{}
    \hlstd{model} \hlkwb{<-} \hlkwd{lmer}\hlstd{(x}\hlopt{~} \hlstd{line} \hlopt{+} \hlstd{(}\hlnum{1}\hlopt{|}\hlstd{animal),} \hlkwc{na.action}\hlstd{=}\hlstr{"na.omit"}\hlstd{)}
    \hlstd{mean_est} \hlkwb{<-} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]} \hlopt{+} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{2}\hlstd{,}\hlnum{1}\hlstd{]}\hlopt{/}\hlnum{2}
    \hlstd{sd_est} \hlkwb{<-} \hlkwd{as.vector}\hlstd{(}\hlkwd{sqrt}\hlstd{(}\hlkwd{t}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlopt{/}\hlnum{2}\hlstd{))} \hlopt{%*%}\hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{vcov}\hlopt{%*%}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlopt{/}\hlnum{2}\hlstd{)))}
  \hlstd{\}}

  \hlkwa{if} \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{3}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlopt{|}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{5}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)} \hlopt{&}
        \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{1}\hlstd{]))}\hlopt{==}\hlnum{8}\hlstd{)}\hlopt{&}\hlstd{(}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{2}\hlstd{]))}\hlopt{==}\hlnum{8}\hlstd{)))\{}
    \hlstd{model} \hlkwb{<-} \hlkwd{lmer}\hlstd{(x}\hlopt{~} \hlstd{cy} \hlopt{+} \hlstd{(}\hlnum{1}\hlopt{|}\hlstd{animal),} \hlkwc{na.action}\hlstd{=}\hlstr{"na.omit"}\hlstd{)}
    \hlstd{mean_est} \hlkwb{<-} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]} \hlopt{+} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{2}\hlstd{,}\hlnum{1}\hlstd{]}\hlopt{/}\hlnum{2}
    \hlstd{sd_est} \hlkwb{<-} \hlkwd{as.vector}\hlstd{(}\hlkwd{sqrt}\hlstd{(}\hlkwd{t}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlopt{/}\hlnum{2}\hlstd{))} \hlopt{%*%}\hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{vcov}\hlopt{%*%}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlopt{/}\hlnum{2}\hlstd{)))}
  \hlstd{\}}

  \hlkwa{if} \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{3}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlopt{&} \hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[cy}\hlopt{==}\hlnum{5}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)} \hlopt{&}
        \hlstd{((}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{1}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)}\hlopt{&}\hlstd{(}\hlkwd{sum}\hlstd{(}\hlkwd{is.na}\hlstd{(x[line}\hlopt{==}\hlnum{2}\hlstd{]))}\hlopt{!=}\hlnum{8}\hlstd{)))\{}
    \hlstd{model} \hlkwb{<-} \hlkwd{lmer}\hlstd{(x}\hlopt{~} \hlstd{cy} \hlopt{+} \hlstd{line} \hlopt{+} \hlstd{(}\hlnum{1}\hlopt{|}\hlstd{animal),} \hlkwc{na.action}\hlstd{=}\hlstr{"na.omit"}\hlstd{)}
    \hlcom{#str(summary(model))}
    \hlstd{mean_est} \hlkwb{<-} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{1}\hlstd{,}\hlnum{1}\hlstd{]} \hlopt{+}
      \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{2}\hlstd{,}\hlnum{1}\hlstd{]}\hlopt{/}\hlnum{2} \hlopt{+}
      \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{coeff[}\hlnum{3}\hlstd{,}\hlnum{1}\hlstd{]}\hlopt{/}\hlnum{2}

    \hlstd{sd_est} \hlkwb{<-} \hlkwd{as.vector}\hlstd{(}\hlkwd{sqrt}\hlstd{(}\hlkwd{t}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlopt{/}\hlnum{2}\hlstd{,} \hlnum{1}\hlopt{/}\hlnum{2}\hlstd{))}\hlopt{%*%} \hlkwd{summary}\hlstd{(model)}\hlopt{$}\hlstd{vcov} \hlopt{%*%}\hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,}\hlnum{1}\hlopt{/}\hlnum{2}\hlstd{,} \hlnum{1}\hlopt{/}\hlnum{2}\hlstd{)))  \}}


  \hlkwd{return}\hlstd{(}\hlkwd{c}\hlstd{(mean_est, sd_est))}
\hlstd{\}}
\hlstd{depleted_out} \hlkwb{<-} \hlkwd{laply}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{236}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{i}\hlstd{)}\hlkwd{out_model}\hlstd{(deplete[i,],} \hlkwc{depleted} \hlstd{=} \hlstr{"TRUE"}\hlstd{))}

\hlstd{whole_out} \hlkwb{<-} \hlkwd{laply}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{236}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{i}\hlstd{)}\hlkwd{out_model}\hlstd{(whole[i,],} \hlkwc{depleted} \hlstd{=} \hlstr{"FALSE"}\hlstd{))}
\end{alltt}
\end{kframe}
\end{knitrout}



\section{Results of Comparison of Standard Errors between Two Sample Types}
Proportion of protein spots whole standard error in the depleted sample larger than that one  in the whole sample.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{mean}\hlstd{(depleted_out[,} \hlnum{2}\hlstd{]} \hlopt{-} \hlstd{whole_out[,} \hlnum{2}\hlstd{]} \hlopt{>} \hlnum{0}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] 0.5254
\end{verbatim}
\end{kframe}
\end{knitrout}


Figure \ref{fig:fg1} show the log of standard error of all protein spots in 2 sample types.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{sd_out} \hlkwb{<-} \hlkwd{data.frame}\hlstd{(}\hlkwc{logsd} \hlstd{=} \hlkwd{log}\hlstd{(}\hlkwd{c}\hlstd{(whole_out[,} \hlstr{"sd"}\hlstd{], depleted_out[,} \hlstr{"sd"}\hlstd{])),} \hlkwc{sample} \hlstd{=} \hlkwd{rep}\hlstd{(}\hlkwd{c}\hlstd{(}\hlstr{"whole"}\hlstd{,}
    \hlstr{"depleted"}\hlstd{),} \hlkwc{each} \hlstd{=} \hlkwd{dim}\hlstd{(whole_out)[}\hlnum{1}\hlstd{]))}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error: subscript out of bounds}}\begin{alltt}
\hlstd{p} \hlkwb{<-} \hlkwd{ggplot}\hlstd{(sd_out,} \hlkwd{aes}\hlstd{(sample, logsd))}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error: object 'sd\_out' not found}}\begin{alltt}
\hlstd{p} \hlopt{+} \hlkwd{geom_boxplot}\hlstd{(}\hlkwd{aes}\hlstd{(}\hlkwc{fill} \hlstd{= sample))} \hlopt{+} \hlkwd{ggtitle}\hlstd{(}\hlstr{"Standard Error for Each Sample Type"}\hlstd{)} \hlopt{+} \hlkwd{scale_fill_discrete}\hlstd{(}\hlkwc{name} \hlstd{=} \hlstr{"Sample Type"}\hlstd{)} \hlopt{+}
    \hlkwd{xlab}\hlstd{(}\hlstr{"Sample Type"}\hlstd{)} \hlopt{+} \hlkwd{ylab}\hlstd{(}\hlstr{"log(Standard Error)"}\hlstd{)} \hlopt{+} \hlkwd{theme}\hlstd{(}\hlkwc{text} \hlstd{=} \hlkwd{element_text}\hlstd{(}\hlkwc{size} \hlstd{=} \hlnum{18}\hlstd{))}
\end{alltt}


{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error: object 'p' not found}}\end{kframe}
\end{knitrout}

Consider a Wilcoxon signed-rank test H0: The standard errors are the same in depleted vs. non-depleted, H1: the standard errors are significantly higher overall in depleted vs. non-depleted.  


 
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlcom{# One-sided Test for the non-transformed standard errors}
\hlkwd{wilcox.test}\hlstd{(depleted_out[,} \hlnum{2}\hlstd{], whole_out[,} \hlnum{2}\hlstd{],} \hlkwc{alternative} \hlstd{=} \hlstr{"greater"}\hlstd{,} \hlkwc{paired} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## 	Wilcoxon signed rank test with continuity correction
## 
## data:  depleted_out[, 2] and whole_out[, 2]
## V = 15567, p-value = 0.06575
## alternative hypothesis: true location shift is greater than 0
\end{verbatim}
\begin{alltt}
\hlcom{# One-sided Test for the log-transformed standard errors}
\hlkwd{wilcox.test}\hlstd{(}\hlkwd{log}\hlstd{(depleted_out[,} \hlnum{2}\hlstd{]}\hlopt{/}\hlstd{whole_out[,} \hlnum{2}\hlstd{]),} \hlkwc{alternative} \hlstd{=} \hlstr{"greater"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## 
## 	Wilcoxon signed rank test with continuity correction
## 
## data:  log(depleted_out[, 2]/whole_out[, 2])
## V = 14983, p-value = 0.1706
## alternative hypothesis: true location is greater than 0
\end{verbatim}
\end{kframe}
\end{knitrout}


\end{document}
